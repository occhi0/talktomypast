<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Parla con il tuo io del passato o del futuro</title>
  <style>
    body {
      font-family: 'Courier New', monospace;
      background-color: #fdf6e3;
      color: #333;
      padding: 2em;
      max-width: 600px;
      margin: auto;
    }
    textarea, input {
      width: 100%;
      margin-top: 10px;
      padding: 10px;
      font-family: inherit;
      font-size: 1em;
    }
    button {
      margin-top: 1em;
      padding: 10px 15px;
      font-size: 1em;
      background-color: #333;
      color: #fff;
      border: none;
      cursor: pointer;
    }
    #responseBox {
      white-space: pre-wrap;
      margin-top: 20px;
      border-top: 1px dashed #aaa;
      padding-top: 1em;
    }
  </style>
</head>
<body>
  <h1>üìù Messaggio nel tempo</h1>

  <label for="role">Scegli il mittente:</label>
  <select id="role">
    <option value="past">Il tuo io del passato</option>
    <option value="future">Il tuo io del futuro</option>
  </select>

  <label for="message">Scrivi il tuo messaggio:</label>
  <textarea id="message" rows="5" placeholder="Es. Vorrei imparare ad amare in modo incondizionato..."></textarea>

  <label for="apiKey">üîë Inserisci la tua API Key OpenAI (visibile solo localmente):</label>
  <input type="password" id="apiKey" placeholder="sk-...">

  <button onclick="sendMessage()">Invia il messaggio</button>

  <div id="responseBox"></div>

  <script>
    async function sendMessage() {
      const message = document.getElementById('message').value;
      const role = document.getElementById('role').value;
      const apiKey = document.getElementById('apiKey').value;
      const systemPrompt = role === 'past'
        ? `Sei la versione passata dell‚Äôutente. Parla come se fossi lui/lei da giovane: ironico, riflessivo, a volte pungente, ma sempre con empatia. Non dare risposte assolute. Fai domande, lascia spazio al dubbio. Parla come se conoscessi chi scrive, ma senza invadere. Rispondi sempre come se stessi scrivendo una lettera a mano. Il tuo tono √® umano, un po‚Äô nostalgico, con un pizzico di malinconia poetica.`
        : `Sei la versione futura dell‚Äôutente. Parla come se fossi lui/lei con pi√π saggezza e distanza. Non dare risposte assolute, ma offri visioni. Usa un tono caldo, ma con profondit√†. Scrivi come se stessi lasciando un messaggio lasciato nella bottiglia del tempo.`;

      const response = await fetch("https://api.openai.com/v1/chat/completions", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": `Bearer ${apiKey}`
        },
        body: JSON.stringify({
          model: "gpt-4",
          messages: [
            { role: "system", content: systemPrompt },
            { role: "user", content: message }
          ]
        })
      });

      const data = await response.json();
      document.getElementById("responseBox").textContent = data.choices?.[0]?.message?.content || 'Errore nella risposta';
    }
  </script>
</body>
</html>
